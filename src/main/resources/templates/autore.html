<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="it"
      xmlns:sec="http://www.thymeleaf.org/extras/springsecurity6">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${autore.nome + ' ' + autore.cognome}">Dettaglio Autore</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/navbar.css}" />
    <link rel="stylesheet" th:href="@{/css/autore.css}">
</head>
<body>
    
    <div th:replace="~{fragments/navbar :: navbar}"></div>

    <div class="container mt-4">
        <!-- Hero Section con Foto e Info Autore -->
        <div class="author-hero">
            <div class="container">
                <div class="author-hero-content">
                    <!-- Foto dell'autore -->
                    <div class="author-photo-container">
                        <div th:if="${autore.fotografia != null}">
                            <img th:src="@{'/autore/foto/' + ${autore.id}}" 
                                 th:alt="${autore.nome + ' ' + autore.cognome}" 
                                 class="author-photo">
                        </div>
                        <div th:unless="${autore.fotografia != null}" class="no-photo">
                            <i class="fas fa-user"></i>
                            <div>Foto non disponibile</div>
                        </div>
                    </div>
     
                    <!-- Informazioni dell'autore -->
                    <div class="author-info">
                        <h1 th:text="${autore.nome + ' ' + autore.cognome}">Nome Cognome</h1>
                        
                        <div class="author-details">
                            <div class="author-detail-item">
                                <i class="fas fa-birthday-cake"></i>
                                <strong>Data di nascita:</strong>
                                <span th:text="${autore.dataNascita}">01/01/1900</span>
                            </div>
                            
                            <div th:if="${autore.dataMorte != null}" class="author-detail-item">
                                <i class="fas fa-cross"></i>
                                <strong>Data di morte:</strong>
                                <span th:text="${autore.dataMorte}">01/01/2000</span>
                            </div>
                            
                            <div class="author-detail-item">
                                <i class="fas fa-flag"></i>
                                <strong>Nazionalit√†:</strong>
                                <span th:text="${autore.nazionalita}">Italiana</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Controlli Admin -->
        <div sec:authorize="hasRole('ADMIN')" class="admin-controls">
            <h3>
                <i class="fas fa-cog"></i>
                Controlli Amministratore
            </h3>
            <div class="admin-buttons">
                <a th:href="@{'/admin/autore/' + ${autore.id} + '/immagine'}" 
                   class="btn-admin">
                    <i class="fas fa-camera"></i>
                    Aggiungi Immagine
                </a>
                
                <form th:action="@{'/admin/autore/' + ${autore.id} + '/elimina'}" 
                      method="post" 
                      style="display: inline;"
                      th:if="${#authorization.expression('hasRole(''ADMIN'')')}">
                    <button type="submit" class="btn-danger-admin">
                        <i class="fas fa-trash"></i>
                        Elimina Autore
                    </button>
                </form>
            </div>
        </div>

        <!-- Sezione Libri dell'Autore -->
        <div class="content-section">
            <h2 class="section-title">
                <i class="fas fa-books"></i>
                Opere dell'Autore
            </h2>
            
            <div th:if="${autore.libri != null and !autore.libri.empty}">
                <div class="books-grid">
                    <a th:each="libro : ${autore.libri}" 
                       th:href="@{'/libro/' + ${libro.id}}" 
                       class="book-card">
                        <div class="book-card-img">
                            <img th:if="${libro.copertina != null}"
                                 th:src="@{'/immagini/' + ${libro.copertina.id}}"
                                 th:alt="${libro.titolo}" />
                            <img th:unless="${libro.copertina != null}"
                                 src="/img/default-book.jpg"
                                 th:alt="${libro.titolo}" />
                        </div>
                        <div class="book-card-content">
                            <h3 th:text="${libro.titolo}">Titolo</h3>
                            <p>
                                <i class="fas fa-calendar-alt"></i>
                                <span th:text="${libro.annoPubblicazione}">Anno</span>
                            </p>
                        </div>
                    </a>
                </div>
            </div>
            
            <div th:unless="${autore.libri != null and !autore.libri.empty}" class="no-books">
                <i class="fas fa-book-open"></i>
                <p>Nessun libro disponibile per questo autore.</p>
            </div>
        </div>
    </div>

</body>
</html>